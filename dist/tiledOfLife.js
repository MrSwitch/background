(()=>{window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||(e=>setTimeout(e,1e3/60));var it=window.requestAnimationFrame.bind(window);var Y={bubbles:!0,cancelable:!0},T=(e,t=Y)=>new Event(e,t);try{T("test")}catch{T=(e,t=Y)=>{let i=document.createEvent("Event");return i.initEvent(e,!!t.bubbles,!!t.cancelable),i}}var v=T;var D=e=>(e.stopPropagation=()=>{},e.preventDefault=()=>{},e);var l=(e,t)=>t&&e instanceof t;var j=typeof HTMLElement<"u"&&HTMLElement||typeof Element<"u"&&Element,N=typeof HTMLDocument<"u"&&HTMLDocument||typeof Document<"u"&&Document,U=window.constructor,P=e=>l(e,j)||l(e,N)||l(e,U);function $(e){return Array.prototype.slice.call(e)}var z=$;function p(e,t=()=>{}){return P(e)?e=[e]:typeof e=="string"&&(e=document.querySelectorAll(e)),l(e,Array)||(e=z(e)),t&&e.forEach(t),e}var V=/[\s,]+/,R=!1;try{let e=Object.defineProperty({},"passive",{get(){R=!0}});window.addEventListener("test",null,e)}catch{}function a(e,t,i,s=!1){return typeof s=="object"&&s.passive&&!R&&(s=!1),t=t.split(V),p(e,n=>t.forEach(o=>n.addEventListener(o,i,s)))}var E=window.navigator.pointerEnabled,B=E?"MSPointerMove pointerMove":"mousemove touchmove",W=E?"MSPointerDown pointerDown":"mousedown touchstart",G=E?"MSPointerUp pointerUp":"mouseup touchend touchcancel";function A(e,t,i,s){let n={},o={},c={};a(document,B,h=>{if(K(h))return;let r=h.pointerId||0,d=n[r];if(d&&typeof d=="function"){let f=o[r];g(h,f),d(h,f)}o[r]=h}),a(document,G,h=>{let r=h.pointerId||0;n[r]=null,(h.type==="touchend"||h.type==="touchcancel")&&(h=o[r]);let d=c[r];d&&d(h),c[r]=null}),p(e,h=>{a(h,"selectstart",()=>!1),a(h,W,r=>{let d=r.pointerId||0;g(r),o[d]=r,n[d]=(f,k)=>{t.call(h,f,k,r)},s&&(c[d]=f=>{g(f,r),s.call(h,f,r)}),i&&i.call(h,r)})})}function g(e,t){if(e.gesture={},e&&e.touches&&e.touches.length>0?e.gesture.touches=e.touches:e.gesture.touches=[e],e.gesture.screenX=e.gesture.touches[0].screenX,e.gesture.screenY=e.gesture.touches[0].screenY,"screenX"in e||(e.screenX=e.gesture.screenX),"screenY"in e||(e.screenY=e.gesture.screenY),t){e.gesture.deltaTime=e.timeStamp-t.timeStamp;let i=e.gesture.deltaX=e.gesture.screenX-t.gesture.screenX,s=e.gesture.deltaY=e.gesture.screenY-t.gesture.screenY;Math.abs(s)>Math.abs(i)?e.gesture.direction=s>0?"up":"down":e.gesture.direction=i>0?"right":"left",e.gesture.distance=Math.sqrt(i*i+s*s),e.gesture.velocity=e.gesture.distance/e.gesture.deltaTime}}function K(e){return(e.pointerType||e.type).match(/mouse/i)&&(e.which||e.buttons)!==1}function S(e,t){return A(e,function(s,n,o){g(s,o),s.gesture.type=`drag${s.gesture.direction}`,t.call(this,s)},function(s){s.gesture.type="start",t.call(this,s)},function(s){let n=s.gesture;n.deltaTime<200&&n.distance>20&&n.velocity>.3?n.type=`swipe${n.direction}`:n.distance<20?n.type="click":n.type="release",t.call(this,s)})}var F="background",q=["click","mousedown","mouseup","mouseover","mousemove","mouseout","frame","resize","keydown"],H=["touchmove","touchstart","touchend"],Z=/[\s,]+/,y=class{constructor(t){let i;if(this.events={},"getContext"in document.createElement("canvas")){t&&t instanceof HTMLCanvasElement?(this.target=t,i=t.parentNode):(i=t,t=document.createElement("canvas"),t.style.backgroundColor="white",i||(i=document.body,t.style.cssText="position:fixed;z-index:-1;top:0;left:0;",t.setAttribute("tabindex",0),document.documentElement.style.cssText="min-height:100%;",document.body.style.cssText="min-height:100%;",window.addEventListener("resize",this.resize.bind(this))),i.insertBefore(t,i.firstElementChild),this.target=t,this.resize()),this.ctx=t.getContext("2d"),this.ctx.save(),this._time=0,this._fps=0,this.draw(),a(this.target,q.toString(),this.dispatchEvent.bind(this),{passive:!0}),a(this.target,H.toString(),this.dispatchTouchEvent.bind(this),{passive:!0}),i===document.body&&t.style.getPropertyValue("z-index")==="-1"&&(a(document,q.toString(),this.dispatchEvent.bind(this),{passive:!0}),a(document,H.toString(),this.dispatchTouchEvent.bind(this),{passive:!0}));{let s=this.target.style,n=s.getPropertyValue("z-index");window.addEventListener("hashchange",C.bind(s,n)),C.call(s,n)}this.swipe&&S(this.target,this.swipe.bind(this))}}get width(){return this.target.width}set width(t){this.target.width=t}get height(){return this.target.height}set height(t){this.target.height=t}get fps(){return this._fps}set fps(t){this._fps=t;let i=new Date().getTime();i-this._time>1e3&&(this._time=i,this._fps=0)}resize(){let t=this.target.parentNode===document.body?document.documentElement:this.target.parentNode,i=t.clientHeight,s=t.clientWidth,n=!1;this.width!==s&&(n=!0,this.width=s),this.height!==i&&(n=!0,this.height=i),n&&this.target.dispatchEvent(v("resize"))}clear(){this.ctx.clearRect(0,0,this.target.width,this.target.height)}bringToFront(){window.location.hash=F}draw(){this.fps++,this.target.dispatchEvent(v("frame")),requestAnimationFrame(this.draw.bind(this))}addEventListener(t,i){t.split(Z).forEach(s=>{s in this.events||(this.events[s]=[]),this.events[s].push(i)})}dispatchEvent(t){t.type in this.events&&(t.currentTarget===document&&(t=D({type:t.type,target:this.target,offsetX:t.pageX||t.offsetX,offsetY:t.pageY||t.offsetY})),this.events[t.type].forEach(s=>s(t)),t.stopPropagation())}dispatchTouchEvent(t){let i=(t.touches||t.changedTouches)[0];i&&(t.offsetX=Math.abs(i.pageX||i.screenX),t.offsetY=Math.abs(i.pageY||i.screenY)),this.dispatchEvent(t)}};function C(e){let t="z-index";window.location.hash===`#${F}`&&(e=1e4),e!==void 0?this.setProperty(t,e):this.removeProperty(t)}var J=["click","mousedown","mouseup","mouseover","mousemove","mouseout","touchmove","touchstart","touchend","frame"],m=class{constructor(t){this.children=[],this.events=[],this.init(t)}init(t){this.target=t,this.ctx=t.getContext("2d"),a(t,J.toString(),this._findAndDispatch.bind(this),{passive:!0})}push(t){t.dirty=!0,this.children.indexOf(t)===-1&&(t.setup&&t.setup(this),this.children.push(t))}findIndex(t){return this.children.findIndex(t)}find(t){return this.children.find(t)}get length(){return this.children.length}set length(t){this.children.length=t}prepare(){this.children.forEach(t=>{t.dirty===!0&&this.prepareChild(t)})}prepareChild(t){let i=this.ctx;t.dirty!=="pending"&&(t.dirty="pending",i.clearRect(t.x,t.y,t.w,t.h),t.previous&&Q(t.previous,t)&&i.clearRect(t.previous.x,t.previous.y,t.previous.w,t.previous.h),this.children.forEach(this._prepareSiblings.bind(this,t)))}_prepareSiblings(t,i){!i.dirty&&i.visible!==!1&&(M(i,t)||t.past&&M(i,t.past))&&this.prepareChild(i)}sort(){this.children.sort((t,i)=>(t=t.zIndex||0,i=i.zIndex||0,+(t>i)||-(t<i)))}draw(){let t=this.ctx;this.children.forEach(i=>{i.frame&&i.frame(t),i.dirty&&i.visible!==!1&&i.draw(t),i.dirty=!1})}elementFromPoint(t,i){let s,n={x:t,y:i,w:1,h:1};return this.children.forEach(o=>{o.visible===!1||!o.w||!o.h||o.pointerEvents===!1||M(n,o)&&(s=o)}),s}addEventListener(t,i){t in this.events||(this.events[t]=[]),this.events[t].push(i)}dispatchEvent(t){t.type in this.events&&this.events[t.type].forEach(i=>i(t))}_findAndDispatch(t){if(typeof MouseEvent<"u"&&t instanceof MouseEvent||typeof TouchEvent<"u"&&t instanceof TouchEvent){let i={x:t.offsetX,y:t.offsetY,w:1,h:1};this.children.forEach(s=>{!s.visible||!s.w||!s.h||!s.pointerEvents||M(i,s)&&s.dispatchEvent(t)})}}};function M(e,t){return!(e.x>t.x+t.w||e.x+e.w<t.x||e.y>t.y+t.h||e.y+e.h<t.y)}function Q(e,t){return e.x!==t.x||e.y!==t.y||e.w!==t.w||e.h!==t.h}var w=class{constructor(t,i){this.items=Array.isArray(t)?t:[],this.handler=i}push(...t){t.forEach(i=>this.items.push(i)),this._handler&&t.forEach(i=>this._handler(i))}get length(){return this.items.length}set length(t){this.items.length=t}get handler(){return this._handler}set handler(t){this._handler=t,this._handler&&this.items.forEach(i=>this._handler(i))}};var tt=window.background=new w(window.background);function et(e){e(u)}var u=class e{static add(t){e.stages.push(t),e.stages.length===1&&(tt.handler=et)}static init(t){let i=e.stages[0];if(i)return new i(t)}};u.stages=[];var L=class{constructor(...t){this.i=Math.round(Math.random()*this.n),this.ascending=!Math.round(Math.random()),this.dx=0,this.dy=0,this.grid=[],this.position(...t)}get n(){return 100}position(t,i,s,n){this.x=t,this.y=i,this.w=s,this.h=n}draw(t){(this.dx||this.dy)&&t.translate(this.dx,this.dy),t.fillStyle=this.fillStyle,t.fillRect(this.x,this.y,this.w,this.h),(this.dx||this.dy)&&t.setTransform(1,0,0,1,0,0)}setup(){}frame(){this.dirty=!0;let t=this.i;if((this.dx||this.dy)&&(this.dy*=.9,this.dx*=.9,Math.abs(this.dx)<.1&&(this.dx=0),Math.abs(this.dy)<.1&&(this.dy=0)),b){let[i,s]=[b.offsetX,b.offsetY],n=i-this.x,o=s-this.y;Math.abs(n)<x&&Math.abs(o)<x&&Math.pow(n,2)+Math.pow(o,2)<Math.pow(x,2)&&(n=.3*(Math.abs(n)/n)*-(x-Math.abs(n)),o=.3*(Math.abs(o)/o)*-(x-Math.abs(o)),n||(n=0),o||(o=0),this.dx+=(n-this.dx)*.5,this.dy+=(o-this.dy)*.5,i>this.x&&(t=t/2+this.n/2),i<this.x&&(t=t/2))}this.fillStyle=`rgba(0, 0, 0, ${t?t/this.n:0})`,this.i<=0?this.ascending=!0:this.i>=this.n&&(this.ascending=!1),this.i+=this.ascending?1:-1}},X=class{constructor(t){let i=new y(t),s=new m(i.target);this.canvas=i,this.collection=s,i.addEventListener("mousemove",O.bind(this)),i.addEventListener("touchmove",O.bind(this)),i.addEventListener("resize",I.bind(this)),i.addEventListener("frame",()=>{i.clear(),s.draw()}),this.tiles=[],I.call(this)}},x=80,b;u.add(X);function I(){let e=this.canvas,t=this.tiles,i=this.collection,s,n;n=s=40;let o=Math.floor(e.width/n),c=Math.floor(e.height/s);n+=Math.floor(e.width%(o*n)/o),s+=Math.floor(e.height%(c*s)/c);for(let h=0;h<o;h++)for(let r=0;r<c;r++){let d=t[h*c+r];d?d.position(h*n+1,r*s+1,n-1,s-1):(d=new L(h*n+1,r*s+1,n-1,s-1),i.push(d),t.push(d)),d.grid=[h,r]}}var _;function O(e){b=e,_&&clearTimeout(_),_=setTimeout(()=>{b=null},100)}})();
//# sourceMappingURL=tiledOfLife.js.map
